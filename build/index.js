/*!
 * 
 *   cross-origin-storage v1.0.11
 *   https://github.com/lorrandavid/cross-origin-storage
 *
 *   Copyright (c) Lorran David (https://github.com/lorrandavid) and project contributors.
 *
 *   This source code is licensed under the MIT license found in the
 *   LICENSE file in the root directory of this source tree.
 *
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.CrossOriginStorage=t():e.CrossOriginStorage=t()}(self,(function(){return(()=>{"use strict";var e,t,i={d:(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},n={};function r(e,t){return!!t.find((function(t){return t.includes(e)}))}function s(e,t,i,n){return{id:e,identifier:t,method:i,data:n}}function o(e){var t;try{t=JSON.parse(e.data)}catch(e){}return t}function a(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}i.r(n),i.d(n,{CrossOriginStorageGuest:()=>l,CrossOriginStorageHost:()=>c}),function(e){e.SET="set",e.CLEAR="clear"}(e||(e={})),function(e){e.READY="onReady"}(t||(t={}));const c=function(){function i(e){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),u(this,"iframe",void 0),u(this,"isInit",!1),u(this,"isReady",!1),u(this,"requestId",-1),u(this,"requests",{}),u(this,"options",{iframeUrl:"",identifier:"",whitelist:[],excludes:[],initCallback:function(){}}),!e.hasOwnProperty("iframeUrl")||this.isInit)throw new Error("Error before initiating");this.init(e)}var n,c,f;return n=i,(c=[{key:"attachEvents",value:function(){window.addEventListener?window.addEventListener("message",this.receiveMessage.bind(this),!1):window.attachEvent("onmessage",this.receiveMessage.bind(this))}},{key:"createIframe",value:function(e){var t=document.createElement("div");t.innerHTML='<iframe id="'.concat(e,'" src="').concat(this.options.iframeUrl,'" style="display: none;"></iframe>'),document.body.appendChild(t),this.iframe=document.getElementById(e)}},{key:"receiveMessage",value:function(e){var i=o(e);if(i&&r(e.origin,this.options.whitelist)){if(i.method!==t.READY||this.isReady)return this.executeCallback(i);this.isReady=!0,this.options.initCallback()}}},{key:"executeCallback",value:function(e){this.requests[e.id]&&(this.requests[e.id](e),delete this.requests[e.id])}},{key:"init",value:function(e){this.isInit=!0,this.options=e;var t=e.identifier;this.attachEvents(),this.createIframe(t)}},{key:"clone",value:function(t){var i=this;this.requestId++,this.requests[this.requestId]=t;var n=s(this.requestId,this.options.identifier,e.SET,{});Object.keys(window.sessionStorage).forEach((function(e){i.options.excludes&&i.options.excludes.includes(e)||(n.data[e]=window.sessionStorage.getItem(e))})),this.iframe.contentWindow.postMessage(JSON.stringify(n),"*")}},{key:"clear",value:function(t){this.requestId++,this.requests[this.requestId]=t;var i=s(this.requestId,this.options.identifier,e.CLEAR,null);this.iframe.contentWindow.postMessage(JSON.stringify(i),"*")}}])&&a(n.prototype,c),f&&a(n,f),i}();function f(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function d(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const l=function(){function i(e){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),d(this,"isInit",!1),d(this,"requestId",-1),d(this,"options",{identifier:"",whitelist:[]}),!e.hasOwnProperty("identifier")||this.isInit)throw new Error("Error before initiating");this.init(e)}var n,a,u;return n=i,(a=[{key:"attachEvents",value:function(){var t=this;window.onmessage=function(i){if(n=window.location.origin,a=i.origin,n!==a){var n,a;if(!r(i.origin,t.options.whitelist))throw new Error("Forbidden origin");var u=o(i);if(u){var c=s(t.requestId,t.options.identifier,e.SET,u.data);u.method===e.SET&&(Object.keys(u.data).forEach((function(e){window.sessionStorage.setItem(e,u.data[e])})),window.parent.postMessage(JSON.stringify(c),"*"))}}}}},{key:"onInitFinished",value:function(e){this.requestId++;var i=s(this.requestId,e,t.READY,null);window.parent.postMessage(JSON.stringify(i),"*")}},{key:"init",value:function(e){this.isInit=!0,this.options=e;var t=e.identifier;this.attachEvents(),this.onInitFinished(t)}}])&&f(n.prototype,a),u&&f(n,u),i}();return n})()}));
//# sourceMappingURL=index.js.map